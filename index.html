<!--
  + version: 1.8.5
  + build: 2021-5-3 19:7:52
  + commit: 5bd991517d20c2cb927889924e94902041ba9249
-->
<!DOCTYPE html>
<html lang=en translate=no>

<head>
    <meta charset=utf-8>
    <meta content="IE=edge,chrome=1" http-equiv=X-UA-Compatible>
    <meta content="width=device-width,initial-scale=1,width=device-width,maximum-scale=1,user-scalable=0" name=viewport>
    <meta content=yes name=full-screen>
    <meta content=application name=browsermode>
    <meta content=true name=x5-fullscreen>
    <meta content=app name=x5-page-mode>
    <title>Live Chat</title>
</head>

<body>
    <script>
    var Comm100API = Comm100API || {};
        (function (t) {
            function e(e) {
                var a = document.createElement("script"), c = document.getElementsByTagName("script")[0];               
                a.type = "text/javascript", a.async = !0, a.src = e + t.site_id, c.parentNode.insertBefore(a, c)
            }

            t.chat_buttons = t.chat_buttons || [], t.chat_buttons.push({
                code_plan: 896,
                div_id: "livechat-button-896"
            }),
            t.site_id = 5000450, 
            t.main_code_plan = 896, 
	    e("https://vue.livelyhelp.chat/livechat.ashx?siteId="),
            setTimeout(function () {
	      console.log("t=====",t,"t.loaded1",t.loaded,);	
                t.loaded || e("https://vue1.livelyhelp.chat/livechat.ashx?siteId=")
            }, 5e3)
    })(Comm100API || {})
      
    console.log("OnlineHelpAPI",window["OnlineHelpAPI"]);
    console.log("window.document",window.document);	    
    //Comm100API = window["OnlineHelpAPI"];
    Comm100API.onReady = function () {
            console.log("Comm100API.onReady");
            var params = {}
            var url = location.search;
            if (url.indexOf("?") != -1) {
                var str = url.substr(1);
                var strs = str.split("&");
                strs.forEach(function (param) {
                    var k = param.split("=")[0];
                    var v = param.split("=")[1];
                    params[k] = decodeURIComponent(v);
                })
            }

            function getParamByKey(k) {
                return params[k];
            }

            // // use API here safely
            const campaignId = 896
            const fields = Comm100API.get('livechat.prechat.fields', campaignId);
            var b = false;
            const visitor = getParamByKey("name");
            fields.forEach(ele => {
                if (ele.type == "name") {
                    ele.value = visitor;
                    b = true;
                }
            });

            if (!b) {
                var n = {
                    isErrorShowed: false,
                    isFocused: false,
                    id: 22118,
                    type: "name",
                    label: "姓名",
                    value: visitor,
                    isRequired: false,
                    error: ""
                }
                fields.push(n)
            }
            const isPrechatSkipped = true;
            Comm100API.set('livechat.prechat.isSkip', isPrechatSkipped);
            Comm100API.set('livechat.prechat.fields', fields, campaignId);
            Comm100API.do('livechat.button.click', campaignId);  
        };
    
    
    </script>


</body>

</html>
